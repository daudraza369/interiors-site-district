[variables]
PATH = "/root/.nix-profile/bin:/nix/var/nix/profiles/default/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/root/.npm-global/bin"

[phases.setup]
nixPkgs = ["nodejs_22", "npm-9_x", "openssl"]
cmds = [
  "npm config set prefix /root/.npm-global",
  "npm install -g pnpm@latest",
  "ln -sf /root/.npm-global/bin/pnpm /usr/local/bin/pnpm",
  "ln -sf /root/.npm-global/bin/pnpm /usr/bin/pnpm"
]

[phases.install]
cmds = ["pnpm install"]

[phases.build]
cmds = ["pnpm run build"]

[start]
cmd = "pnpm start"

